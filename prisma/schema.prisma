generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model News {
  id        String   @id @default(cuid())
  title     String
  slug      String   @unique
  content   String
  image     String?
  published Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  metaDesc  String?
  metaTitle String?
  views     Int      @default(0)

  @@map("news")
}

model Gallery {
  id           String   @id @default(cuid())
  title        String
  description  String?
  videoUrl     String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  category     String   @default("Kegiatan")
  categoryIcon String   @default("RiVideoLine")

  @@map("gallery")
}

model Program {
  id              String   @id @default(cuid())
  title           String
  slug            String   @unique
  degree          String
  subtitle        String
  description     String
  longDescription String
  heroImage       String
  color           String   @default("#F15A24")
  competencies    Json
  careers         Json
  tools           Json
  stats           Json
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("programs")
}

model Admin {
  id               String     @id @default(cuid())
  email            String     @unique
  name             String?
  createdAt        DateTime   @default(now())
  updatedAt        DateTime   @updatedAt
  role             Role       @default(NEWS_EDITOR)
  twoFactorEnabled Boolean    @default(false)
  twoFactorSecret  String?
  auditLogs        AuditLog[]

  @@map("admins")
}

model AuditLog {
  id        String   @id @default(cuid())
  adminId   String
  action    String
  entity    String
  entityId  String?
  details   Json?
  ipAddress String?
  userAgent String?
  createdAt DateTime @default(now())
  admin     Admin    @relation(fields: [adminId], references: [id], onDelete: Cascade)

  @@map("audit_logs")
}

model ContactMessage {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String?
  message   String
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
  category  String?
  phone     String?

  @@map("contact_messages")
}

model DailyStat {
  id        String   @id @default(cuid())
  date      DateTime @unique @default(now())
  visitors  Int      @default(0)
  pageViews Int      @default(0)

  @@map("daily_stats")
}

model Setting {
  id        String   @id @default(cuid())
  key       String   @unique
  value     String
  updatedAt DateTime @updatedAt

  @@map("settings")
}

enum Role {
  SUPER_ADMIN
  NEWS_EDITOR
  ACADEMIC_ADMIN
}
